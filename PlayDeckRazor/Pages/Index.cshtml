@page "{CollectionSearch?}"
@using PlayDeckRazor.Pages.Shared
@model IndexModel
@{
    ViewData["Title"] = "Home";
}

<div x-data="{
            gameTitle: '', 
            gameId: '',
            editMode: false,
            setInfo(id, title) {this.gameId = id; this.gameTitle=title;}
            }">
    <div class="modal fade" id="delete-modal" tabindex="-1" role="dialog" aria-labelledby="delete-modal-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="delete-modal-title">Warning!</h2>
                </div>
                <div class="modal-body">
                    <p>
                        Are you sure you want to remove <span style="color: #eb4155; font-weight: bold" x-text="gameTitle"></span> from your collection? If you want to change which deck
                        the game belongs to, use the edit button.
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" title="Cancel">Cancel</button>
                    <form x-on:submit.prevent="SendDelete()" method="post" id="delete-modal-form" asp-page-handler="delete">
                        <input type="hidden" asp-for="GameDeleteId" x-model="gameId"/>
                        <input x-on:submit.prevent="{}" type="submit" value="I'm Sure" class="btn btn-danger" title="Delete game" data-bs-toggle="modal" data-bs-target="#delete-modal"/>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    @* These decks will always be displayed first *@
    <div id="default-decks-container" class="d-flex flex-column justify-content-center">
        @{
            @* Deck ID 1 = Currently Playing (On Deck) *@
            ViewData["Deck"] = Model.Decks[1];
            await Html.RenderPartialAsync("_DeckDisplay", Model);
        }
        @{
            @* Deck ID 2 = Complete *@
            ViewData["Deck"] = Model.Decks[2];
            await Html.RenderPartialAsync("_DeckDisplay", Model);
        }
        @{
            @* Deck ID 3 = Wishlist *@
            ViewData["Deck"] = Model.Decks[3];
            await Html.RenderPartialAsync("_DeckDisplay", Model);
        }
    </div>
    
    @* Space for custom decks *@
    
    @{
        @* Deck ID 0 = Collection / Unassigned *@
        ViewData["Deck"] = Model.Decks[0];
        await Html.RenderPartialAsync("_DeckDisplay", Model);
    }
    
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <img src="favicon.ico" class="rounded me-2" alt="...">
          <strong class="me-auto" id="toast-operation">Deleted</strong>
          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
          <span style="color: #eb4155; font-weight: bold" x-text="gameTitle"></span> <span id="toast-operation-text">was removed from the database.</span>
        </div>
      </div>
    </div>
</div>


